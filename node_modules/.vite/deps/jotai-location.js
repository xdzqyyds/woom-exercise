import {
  RESET
} from "./chunk-MCX3RIGR.js";
import {
  atom
} from "./chunk-EBSEAKO4.js";
import "./chunk-5WWUZCGV.js";

// node_modules/jotai-location/dist/index.modern.js
function t() {
  return t = Object.assign ? Object.assign.bind() : function(n) {
    for (var o = 1; o < arguments.length; o++) {
      var t2 = arguments[o];
      for (var e2 in t2)
        Object.prototype.hasOwnProperty.call(t2, e2) && (n[e2] = t2[e2]);
    }
    return n;
  }, t.apply(this, arguments);
}
var e = () => "undefined" != typeof window && window.location ? { pathname: window.location.pathname, searchParams: new URLSearchParams(window.location.search), hash: window.location.hash } : {};
var a = (n, o) => {
  const t2 = new URL(window.location.href);
  "pathname" in n && (t2.pathname = n.pathname), "searchParams" in n && (t2.search = n.searchParams.toString()), "hash" in n && (t2.hash = n.hash), null != o && o.replace ? window.history.replaceState(window.history.state, "", t2) : window.history.pushState(null, "", t2);
};
var i = (n) => (window.addEventListener("popstate", n), () => window.removeEventListener("popstate", n));
function r(o) {
  var r2;
  const s2 = (null == o ? void 0 : o.getLocation) || e, l2 = (null == o ? void 0 : o.applyLocation) || a, c2 = (null == o ? void 0 : o.subscribe) || i, h = atom(null != (r2 = null == o ? void 0 : o.preloaded) ? r2 : s2());
  return h.debugPrivate = true, h.onMount = (n) => {
    const o2 = () => n(s2()), t2 = c2(o2);
    return o2(), t2;
  }, atom((n) => n(h), (n, e2, a2, i2 = {}) => {
    e2(h, a2), l2(n(h), t({}, o, i2));
  });
}
var s = (n) => {
  window.location.hash = n;
};
var l = (n) => {
  window.history.replaceState(window.history.state, "", `${window.location.pathname}${window.location.search}#${n}`);
};
function c(t2, e2, a2) {
  const i2 = (null == a2 ? void 0 : a2.serialize) || JSON.stringify, r2 = (null == a2 ? void 0 : a2.deserialize) || ((n) => (o) => {
    try {
      return JSON.parse(o);
    } catch (o2) {
      return n;
    }
  })(e2), c2 = (null == a2 ? void 0 : a2.subscribe) || ((n) => (window.addEventListener("hashchange", n), () => {
    window.removeEventListener("hashchange", n);
  })), h = "undefined" != typeof window && !!window.location, w = atom(h ? new URLSearchParams(window.location.hash.slice(1)).get(t2) : null);
  w.onMount = (n) => {
    if (!h)
      return;
    const o = () => {
      n(new URLSearchParams(window.location.hash.slice(1)).get(t2));
    }, e3 = c2(o);
    return o(), e3;
  };
  const d = atom((n) => {
    const o = n(w);
    return null === o ? e2 : r2(o);
  });
  return atom((n) => n(d), (n, e3, r3, c3) => {
    var h2;
    const u = "function" == typeof r3 ? r3(n(d)) : r3, p = new URLSearchParams(window.location.hash.slice(1));
    if (u === RESET)
      e3(w, null), p.delete(t2);
    else {
      const n2 = i2(u);
      e3(w, n2), p.set(t2, n2);
    }
    var v;
    ("replaceState" === (v = null != (h2 = null == c3 ? void 0 : c3.setHash) ? h2 : null == a2 ? void 0 : a2.setHash) ? l : "function" == typeof v ? v : s)(p.toString());
  });
}
export {
  c as atomWithHash,
  r as atomWithLocation
};
//# sourceMappingURL=jotai-location.js.map
